{{{{vue-js}}}}

<div class="app">
	<div class="sidebar">
		<div class="sidebar_entry" v-for="tab in tabs" v-bind:key="tab.id" v-bind:class="currentTab === tab.id ? activeTabClass : ''" v-on:click="currentTab = tab.id">
			<span class="im" v-bind:class="tab.iconClass"></span>
		</div>
	</div>

	<div class="tabs">
		<tab-players v-if="currentTab === 'players'" v-bind:players="players"></tab-players>
		<tab-logs v-if="currentTab === 'logs'" v-bind:logs="logs"></tab-logs>
	</div>

</div>

{{{{/vue-js}}}}

<p>test</p>

<script type="text/javascript">
	let vm = new Vue({
		el: '.app',
		data: {
			tabs: [{
				id: "players",
				name: "Players",
				iconClass: "im-user-male"
			},{
				id: "logs",
				name: "Logs",
				iconClass: "im-note-o"
			}],
			currentTab: "players",
			activeTabClass: 'active',

			players: [{
				id: 1,
				name: "Pony",
				steamid: "x64",
				roles: [{
					id: 0,
					name: 'owner',
					isEnabled: false
				},{
					id: 1,
					name: 'admin',
					isEnabled: true
				}]
			},{
				id: 2,
				name: "Carsa",
				steamid: "x32",
				roles: [{
					id: 0,
					name: 'owner',
					isEnabled: true
				},{
					id: 1,
					name: 'admin',
					isEnabled: true
				}]
			}],

			logs: [{
				time: new Date().getTime(),
				message: 'server started'
			},{
				time: new Date().getTime(),
				message: 'fondling ponies'
			},{
				time: new Date().getTime(),
				message: 'loading lasers'
			}]
		}
	});

</script>


<script type="text/javascript" src="/static/scripts/websock.js"></script>

<script type="text/javascript">
	$(window).on('load', ()=>{
		let ws = new WebSock('ws://' + window.location.host + '/ws', 'XYZ')

		ws.on('open', ()=>{
			console.log('WebSock is now open')

			setTimeout(()=>{
				ws.send('test').then((res)=>{
					console.log('test response success', res)
				}).catch((err)=>{
					console.warn('test response unsuccessful', err)
				})
			}, 1000)
		})

		ws.on('close', ()=>{
			console.log('WebSock is now closed')
		})

		ws.on('message', (data)=>{
			return new Promise((fulfill, reject)=>{
				console.log('WebSock received message', data)

				fulfill('resultsky')
			})
		})
	})
</script>


